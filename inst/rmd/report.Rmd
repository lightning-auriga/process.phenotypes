---
title: "Report Template for Audited Phenotype Files"
output:
  html_document:
    code_folding: hide
  highlight: tango
  number_sections: no
  theme: default
  toc: yes
  toc_depth: 3
  toc_float:
    collapsed: no
    smooth_scroll: yes
  params:
    dataset.name: ""
    variable.summary: NULL
    phenotype.data: ""
---

## Load required R packages

```{r load.packages, eval=TRUE, echo=FALSE}
library(ggplot2, quietly = TRUE)
library(knitr, quietly = TRUE)
library(kableExtra, quietly = TRUE)
```

***
<br>

## Report linking between input and standardized variable names

```{r report.variable.mappings, eval=TRUE, echo=FALSE, results="asis"}
variable.mapping.df <- data.frame(
  names(variable.summary),
  sapply(variable.summary, function(i) {
    i$original.name
  })
)
rownames(variable.mapping.df) <- NULL
colnames(variable.mapping.df) <- c("Standardized", "Original")
knitr::kable(variable.mapping.df, caption = "Phenotype Variable Names")
```

***
<br>

## Report all unique values for string variables

```{r report.value.summary, eval=TRUE, echo=FALSE, results="asis"}
for (name in names(variable.summary)) {
  my.summ <- variable.summary[[name]]$summary
  if (length(my.summ) < nrow(phenotype.data) / 10) {
    variable.summary.df <- data.frame(
      names(my.summ), as.vector(my.summ)
    )
    rownames(variable.summary.df) <- NULL
    colnames(variable.summary.df) <- c("Value", "Summary statistics")
    print(knitr::kable(variable.summary.df, caption = paste("Summary of ", name, " (", variable.summary[[name]]$original.name, ")", sep = "")))
  }
}
```

***
<br>

## Session Information

<br>

The following summarizes the loaded R configuration for the run that created this report.

```{r session.info, eval=TRUE, echo=TRUE}
sessionInfo()
```
